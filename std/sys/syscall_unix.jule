// Copyright 2022 The Jule Project Contributors. All rights reserved.
// Use of this source code is governed by a BSD 3-Clause
// license that can be found in the LICENSE file.

let STDIN: uintptr = 0
let STDOUT: uintptr = 1
let STDERR: uintptr = 2

fn Rmdir(path: str)! {
	Unlinkat(AT_FDCWD, path, AT_REMOVEDIR)?
}

fn Send(s: int, buf: []byte, flags: int)! {
	Sendto(s, buf, flags, 0, 0)?
}

fn CloseOnExec(fd: int) { Fcntl(fd, F_SETFD, FD_CLOEXEC) else {} }

fn SetNonblock(fd: int, nonblocking: bool)! {
	mut flag := Fcntl(fd, F_GETFL, 0)?
	if (flag&O_NONBLOCK != 0) == nonblocking {
		ret
	}
	if nonblocking {
		flag |= O_NONBLOCK
	} else {
		flag &= ^O_NONBLOCK
	}
	Fcntl(fd, F_SETFL, flag)?
}