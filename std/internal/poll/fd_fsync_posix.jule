// Copyright 2025 The Jule Project Contributors. All rights reserved.
// Use of this source code is governed by a BSD 3-Clause
// license that can be found in the LICENSE file.

#build linux

use "std/runtime"
use "std/sys"

impl FD {
	// Wraps sys::Fsync.
	async fn Fsync(mut *self)! {
		if runtime::adjustbudget() {
			runtime::yield().await
		}
		self.incref()?
		defer { self.decref() else {} }
		fd := int(self.File)
		ignoringEINTR(fn|| sys::Fsync(fd)?)?
	}
}